LXI H, C200
LXI SP, C3FF
LDA C100
MOV C,A
LOOP3: LXI D,C250
LDA C102
STA C103
LOOP2: LDA C101
MOV B,A
MVI A,00
STA C105
LOOP1: CALL MUL
CALL SUM
INX H
CALL ADD1
DCR B
JNZ LOOP1
PUSH PSW
LDA C100
SUB C
MOV L,A
MVI A,00
JZ SKIP
ABC: CALL ADD2
DCR L
JNZ ABC
SKIP: MOV L,A
LDA C101
MOV B,A
ORGD: CALL SUB
DCR B
JNZ ORGD
INX D
LDA C103
DCR A
STA C103
JNZ LOOP2
CALL ADD3
DCR C
JNZ LOOP3
LXI H,C100
LXI D,C102
CALL MUL
MOV D,A
LXI H,C350
STORE: POP B
MOV A,B
MOV M,A
DCX H
DCR D
JNZ STORE
HLT

MUL: PUSH B
MOV A,M
MOV B,A
XCHG
MOV A,M
XCHG
MOV C,A
MVI A,00
SMTG: ADD C
DCR B
JNZ SMTG
POP B
RET

SUM: PUSH B
MOV B,A
LDA C105
ADD B
STA C105
POP B
RET

ADD1: PUSH PSW
PUSH B
LDA C102
ADD E
MOV E,A
POP B
POP PSW
RET

ADD2: PUSH B
MOV B,A
LDA C101
ADD B
POP B
RET

ADD3: PUSH B
PUSH PSW
LDA C101
ADD L
MOV L,A
POP PSW
POP B
RET

SUB: PUSH B
PUSH PSW
LDA C102
MOV B,A
MOV A,E
SUB B
MOV E,A
POP PSW
POP B
RET
